<!DOCTYPE html>
<html>
<head>
    <title>Redirecting...</title>
    <meta charset="utf-8" />
    <script type="text/javascript">
        function redirect() {
            // This is the port your WPF application will be listening on.
            // Make sure this port matches the one in your C# code.
            const localPort = 12345;

            // Get the query parameters from the current URL.
            const params = new URLSearchParams(window.location.search);
            const code = params.get('code');
            const error = params.get('error');

            if (code) {
                // If we found a code, redirect to the local listener.
                window.location.replace(`http://localhost:${localPort}/?code=${encodeURIComponent(code)}`);
            } else if (error) {
                // If there was an error, forward it as well.
                const errorDescription = params.get('error_description');
                window.location.replace(`http://localhost:${localPort}/?error=${encodeURIComponent(error)}&error_description=${encodeURIComponent(errorDescription)}`);
            } else {
                // Fallback for unexpected situations.
                document.getElementById("message").innerText = "Error: Could not find the required 'code' parameter in the URL.";
            }
        }
    </script>
</head>
<body onload="redirect()">
    <h1 id="message">Please wait, you are being redirected back to the application...</h1>
</body>
</html>
